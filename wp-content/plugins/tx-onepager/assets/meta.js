!function(e){function t(e){return e&&("onepage.php"===e||0===e.indexOf("op-"))}function o(t){var o={action:"onepager_get_sections",pageId:t};e.post(ajaxurl,o,function(e){e.success?n({sections:e.sections,name:"template.json"}):alert("oops!! onepager could not export this page")})}function n(e){var t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),o=document.getElementById("downloadAnchorElem");o.setAttribute("href",t),o.setAttribute("download","template.json"),o.click()}function a(e,t){var o={action:"onepager_select_layout",layoutId:t,pageId:e};r(o)}function i(){var t={action:"onepager_get_sections",pageId:onepager.pageId},o={action:"save_sections",updated:null,pageId:onepager.pageId,sections:[]};e.post(ajaxurl,t,function(e){if(e&&e.success&&0!==e.sections.length){var t="Are you sure you want to insert this layout?This layout will replace your current layout!",n=confirm(t);if(!n)return;r(o)}else r(o)})}function r(t){e.post(ajaxurl,t,function(e){e&&e.success?location.href=onepager.buildModeUrl:alert("failed to insert layout ")})}e(function(e){function n(){f.val("onepage.php"),f.trigger("change"),I.click()}function r(){f.val("default"),f.trigger("change")}function c(){var t="Are you sure you want to insert this layout?This layout will replace your current layout!",o=e(this).attr("data-layout-id"),n=confirm(t);n&&a(u,o)}function l(e){o(u),e.preventDefault()}function s(){var o=e(this).val();setTimeout(function(){t(o)?(h.hide(),p.hide(),g.show(),b.show()):(h.show(),p.show(),g.hide(),b.hide())},10)}var u=onepager.pageId,p=e('<button type="button" id="enable-onepager" class="op-btn op-btn-with-logo">Enable Onepager</button>'),g=e('<button type="button" id="disable-onepager" class="op-btn op-btn-with-logo">Disable Onepager</button>'),d=e(".op-select-preset"),h=e("#postdivrich"),f=e("#page_template"),y=e("#onepager-export-layout"),b=e("#onepager_meta"),v=e("#blank-template"),w=e("#op-group-filter select"),m=e("#op-presets>.media"),I=e("#publish");window.exportSections=function(){y.click()},w.on("change",function(){var t=e(this).val();return"all"===t?void m.show():(m.hide(),void e(".og-"+t).show())}),y.on("click",l),f.on("change",s),d.on("click",c),v.on("click",i),p.on("click",n),g.on("click",r),f.trigger("change"),h.before(p),h.before(g)})}(jQuery);